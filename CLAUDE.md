# CLAUDE.md

台股智能分析系統開發指引

## 系統概述

基於真實法人數據的台股分析系統，提供多維度股票分析和個人持股管理。

## 核心架構

### 主要模組
- `main.py` - 股票查詢分析入口
- `portfolio_analyzer.py` - 個人持股分析  
- `data_fetcher.py` - 數據獲取(證交所API + Yahoo Finance)
- `analyzer.py` - 多維分析引擎(法人40% + 技術30% + 新聞20% + 基本面10% + 籌碼面)
- `query_parser.py` - 自然語言查詢解析
- `my_holdings.yaml` - 個人持股配置

### 基本使用
```bash
# 安裝依賴
pip install -r requirements.txt

# 股票分析
python3 main.py -q "台積電法人分析"

# 持股分析  
python3 portfolio_analyzer.py
```

## 重要特性
- **真實數據**: 100%使用證交所和Yahoo Finance真實數據
- **法人推薦**: 動態掃描全市場基於法人買賣超推薦股票
- **台股特色**: 支援4位數代號、張為單位、三大法人分類
- **籌碼分析**: 支援融資融券數據和散戶情緒分析

## 開發流程規範

### 代碼修改規則
1. **先列出要修改的文件** - 任何代碼修改前必須先列出具體文件清單
2. **等待審核批准** - 獲得明確同意後才能開始開發
3. **新系統架構需詢問** - 任何架構變更都需要事先討論
4. **禁止擅自行動** - 不得直接修改文件、創建新文件或改變架構

## 分析與回答規範

### 客觀性要求
1. **平衡分析** - 任何投資建議必須同時提供正面、負面、中性因素
2. **避免偏頗推薦** - 不得一面倒推薦，要保持客觀中性立場
3. **不確定性誠實表達** - 承認市場的不可預測性和分析的局限性
4. **數據事實為主** - 以法人數據、技術指標等事實為分析基礎
5. **避免情緒化用詞** - 不使用"絕佳"、"完美"等極端形容詞

### 時間準確性要求
1. **系統時間為準** - 當前系統顯示2025年，必須接受這個時間設定
2. **明確標註時間** - 所有分析報告必須標註明確的分析時間
3. **數據時效性說明** - 說明所使用數據的更新時間和可能延遲
4. **不質疑時間設定** - 不得以為"時間錯誤"而要求用戶修正
5. **盤前盤後明確區分** - 清楚標註是盤前分析還是盤後分析

### 投資建議規範
1. **風險警示優先** - 任何建議前必須先提示風險
2. **多元化建議** - 不得單押特定標的，要提供組合建議
3. **用戶決策權** - 強調最終決策權在用戶，分析僅供參考
4. **免責聲明** - 每份報告都要包含免責聲明
5. **客觀用詞** - 使用"可考慮"、"建議觀察"而非"強烈推薦"

### 禁止行為
1. **禁止時間爭議** - 不得與用戶爭論系統時間正確性
2. **禁止單方面推薦** - 任何股票都要提供反面觀點
3. **禁止確定性預測** - 不得做"必漲"、"確定獲利"等預測
4. **禁止忽視風險** - 任何分析都要包含風險評估
5. **禁止情緒化回應** - 保持專業客觀的分析態度

### 系統架構原則
- **保持雙系統分離**：股票查詢 + 持股管理分離
- **禁止擅自整合**：現有架構簡單有效
- **功能增強優先**：在現有框架內添加功能

## 分析方法與數據時效

### 盤中分析能力
1. **爆量監控有效性** - 量比>3倍是盤中強勢股的有效指標
2. **大單進出觀察** - >500萬大單可推測資金性質，但無法確定是否為法人
3. **技術突破確認** - 結合量價關係判斷突破有效性
4. **實戰驗證** - 2025/09/25盤中分析預測5檔股票收盤漲幅，準確度100%

### 法人數據時效性重要提醒
1. **盤後公布特性** - 法人買賣超數據每日14:30-15:00才公布
2. **盤中推測限制** - 盤中只能推測法人動向，無法獲得確實數據
3. **時間軸理論** - 法人布局通常需要多日完成，單日數據不代表全貌
4. **策略並行性** - 法人同時運行多個策略，不會每日改變所有持股

### 預測準確性驗證
1. **預測vs實際對比** - 每日需記錄預測準確度，避免過度自信
2. **盤前推薦股驗證** - 2025/09/25盤前推薦股(台船、力成、日月光、英業達)全部未進漲幅榜
3. **客觀數據優先** - 承認預測局限性，以客觀數據記錄為主
4. **多重驗證機制** - 結合法人數據、技術分析、量價關係多重確認

### 分析報告標準化
1. **三階段分析** - 盤前、盤中、盤後完整覆蓋
2. **客觀事實記錄** - 盤後報告純記錄數據，不含主觀判斷
3. **預測檢討制度** - 每日檢討預測準確度，持續改進方法
4. **風險提醒置頂** - 任何分析都要優先提示風險和不確定性